<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Display the values of a numeric 2D matrix or data frame as colored
  rectangles or hexagons."><title>Display a numeric matrix as color matrix — color2D.matplot • plotrix</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Display a numeric matrix as color matrix — color2D.matplot"><meta property="og:description" content="Display the values of a numeric 2D matrix or data frame as colored
  rectangles or hexagons."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">plotrix</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.8-6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/plotrix/plotrix/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Display a numeric matrix as color matrix</h1>
      
      <div class="d-none name"><code>color2D.matplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Display the values of a numeric 2D matrix or data frame as colored
  rectangles or hexagons.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">color2D.matplot</span><span class="op">(</span><span class="va">x</span>,cs1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,cs2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,cs3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>  extremes<span class="op">=</span><span class="cn">NA</span>,cellcolors<span class="op">=</span><span class="cn">NA</span>,show.legend<span class="op">=</span><span class="cn">FALSE</span>,nslices<span class="op">=</span><span class="fl">10</span>,xlab<span class="op">=</span><span class="st">"Column"</span>,</span>
<span>  ylab<span class="op">=</span><span class="st">"Row"</span>,do.hex<span class="op">=</span><span class="cn">FALSE</span>,axes<span class="op">=</span><span class="cn">TRUE</span>,show.values<span class="op">=</span><span class="cn">FALSE</span>,vcol<span class="op">=</span><span class="cn">NA</span>,vcex<span class="op">=</span><span class="fl">1</span>,</span>
<span>  border<span class="op">=</span><span class="st">"black"</span>,na.color<span class="op">=</span><span class="cn">NA</span>,xrange<span class="op">=</span><span class="cn">NULL</span>,color.spec<span class="op">=</span><span class="st">"rgb"</span>,yrev<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>  xat<span class="op">=</span><span class="cn">NULL</span>,yat<span class="op">=</span><span class="cn">NULL</span>,Hinton<span class="op">=</span><span class="cn">FALSE</span>,add<span class="op">=</span><span class="cn">FALSE</span>,<span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>data values</p></dd>

 <dt>cs1,cs2,cs3</dt>
<dd><p>the color parameters that will be scaled to represent
  the range of numeric values. (see <samp>color.scale</samp>)</p></dd>

 <dt>extremes</dt>
<dd><p>The colors for the extreme values of <samp>x</samp>. Takes
  precedence over the color ranges.</p></dd>

 <dt>cellcolors</dt>
<dd><p>A precalculated matrix of cell colors. This must have
  the same number of rows and columns as the matrix or it will be
  uninformative. It can be a vector, but be careTakes precedence over both <samp>extremes</samp>
  and color ranges.</p></dd>

 <dt>show.legend</dt>
<dd><p>whether to display a color legend with the
  extreme numeric values in the lower left corner of the plot. This will
  force the color specification to "rgb", so if this is different from
  the color specification requested, call <samp>color.legend</samp> separately.</p></dd>

 <dt>nslices</dt>
<dd><p>The number of color "slices" in the legend.</p></dd>

 <dt>xlab,ylab</dt>
<dd><p>axis labels for the plot.</p></dd>

 <dt>do.hex</dt>
<dd><p>plot packed hexagons instead of rectangles.</p></dd>

 <dt>axes</dt>
<dd><p>Whether to suppress the default axis labelling.</p></dd>

 <dt>show.values</dt>
<dd><p>Whether to display the numeric values of <samp>x</samp>.
  This also controls the number of decimal places displayed.</p></dd>

 <dt>vcol</dt>
<dd><p>The color for the value display. If NA, the values are displayed
  in black or white depending upon the darkness of the cell color.</p></dd>

 <dt>vcex</dt>
<dd><p>The character expansion for the value display.</p></dd>

 <dt>border</dt>
<dd><p>The color(s) for the borders of the cells. Pass NA
  if no border is  wanted.</p></dd>

 <dt>na.color</dt>
<dd><p>The color to use for NA values of <samp>x</samp>.</p></dd>

 <dt>xrange</dt>
<dd><p>An explicit range for the transformation of colors.
  see <samp>color.scale</samp></p></dd>

 <dt>color.spec</dt>
<dd><p>The color specification system to use.</p></dd>

 <dt>yrev</dt>
<dd><p>Whether to reverse the order of the y-axis to display the
  cells in "reading" order (left to right and top to bottom) if TRUE,
  or in the order of a typical plot (left to right and bottom to top) if
  FALSE.</p></dd>

 <dt>xat,yat</dt>
<dd><p>Values at which to place tick marks to override <samp>pretty</samp>.</p></dd>

 <dt>Hinton</dt>
<dd><p>Whether to display a Hinton diagram in which the magnitude of
  cell values is proportional to the size of the squares and the sign is
  indicated by the color of the squares.</p></dd>

 <dt>add</dt>
<dd><p>If TRUE, no plot is created and the rectangles are displayed over
  whatever is on the current device (see the "iris" example).</p></dd>

 <dt>...</dt>
<dd><p>arguments passed to <samp>plot</samp>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>nil</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Displays a plot with the same number of rectangular or hexagonal cells as
 there are numeric values in the matrix or data frame. Each rectangle is
 colored to represent its corresponding value. The rectangles are arranged
 in the conventional display of a 2D matrix with rows beginning at the top
 and columns at the left. To get the rows beginning at the bottom, use
 <samp>yrev=FALSE</samp>. The color scale defaults to black for the minimum
 value and white for the maximum.</p> 
<p>The user will have to adjust the plot device dimensions to get regular
 squares or hexagons, especially when the matrix is not square. As the
 margins are not equivalent for all display devices, this is currently
 a matter of trial and error. Drawing hexagons is quite slow.</p> 
<p><samp>show.values</samp> and <samp>show.legend</samp> are also used to control the
 number of decimal places displayed if the values or legend are shown.
 <samp>TRUE</samp> will give one decimal place, <samp>2</samp> two, and so on.</p>
<p>if <samp>Hinton</samp> is TRUE, a Hinton diagram in which the sizes of the
 squares are proportional to the absolute value of <samp>x</samp> and the colors
 of the squares indicate the sign of the <samp>x</samp> values will be displayed.
 This only works with squares.</p> 
<p>If <samp>add</samp> is true, the color matrix is added to the current plot. This
 is probably only useful when displaying plots that are mostly transparent.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The function <a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a> performs almost the same when passed a
 matrix of values without grid positions, except that it assigns values to
 a specified list of colors rather than calculating a color for each distinct
 value.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Jim Lemon (thanks to Ashoka Polpitiya for <samp>axes</samp>)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="color.scale.html">color.scale</a>, <a href="fill.corner.html">fill.corner</a>, <a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1024</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">32</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># simulate a correlation matrix with values -0.5 to 0.5</span></span></span>
<span class="r-in"><span> <span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="rescale.html">rescale</a></span><span class="op">(</span><span class="va">x</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># add a column with the extreme values (-1,1) to calculate</span></span></span>
<span class="r-in"><span> <span class="co"># the colors, then drop the extra column in the result</span></span></span>
<span class="r-in"><span> <span class="va">cellcol</span><span class="op">&lt;-</span><span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">x</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">31</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">32</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="fu">color2D.matplot</span><span class="op">(</span><span class="va">x</span>,cellcolors<span class="op">=</span><span class="va">cellcol</span>,main<span class="op">=</span><span class="st">"Blue to red correlations"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># do the legend call separately to get the full range</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="color.legend.html">color.legend</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">4</span>,<span class="fl">10</span>,<span class="op">-</span><span class="fl">3</span>,legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  rect.col<span class="op">=</span><span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>,align<span class="op">=</span><span class="st">"rb"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="color2D.matplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># generate colors that show negative values in red to brown</span></span></span>
<span class="r-in"><span> <span class="co"># and positive in blue-green to green</span></span></span>
<span class="r-in"><span> <span class="va">cellcol</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#000000"</span>,<span class="fl">100</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">cellcol</span><span class="op">[</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.8</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">cellcol</span><span class="op">[</span><span class="va">x</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># now do hexagons without borders</span></span></span>
<span class="r-in"><span> <span class="fu">color2D.matplot</span><span class="op">(</span><span class="va">x</span>,cellcolors<span class="op">=</span><span class="va">cellcol</span>,xlab<span class="op">=</span><span class="st">"Columns"</span>,ylab<span class="op">=</span><span class="st">"Rows"</span>,</span></span>
<span class="r-in"><span>  do.hex<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="st">"2D matrix plot (hexagons)"</span>,border<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># for this one, we have to do the color legend separately</span></span></span>
<span class="r-in"><span> <span class="co"># because of the two part color scaling</span></span></span>
<span class="r-in"><span> <span class="va">legval</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,length.out<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">legcol</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#000000"</span>,<span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">legcol</span><span class="op">[</span><span class="va">legval</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="va">legval</span><span class="op">[</span><span class="va">legval</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.8</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">legcol</span><span class="op">[</span><span class="va">legval</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="va">legval</span><span class="op">[</span><span class="va">legval</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="color.legend.html">color.legend</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">1.8</span>,<span class="fl">3</span>,<span class="op">-</span><span class="fl">1.4</span>,<span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,rect.col<span class="op">=</span><span class="va">legcol</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="color2D.matplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="co"># do a color only association plot</span></span></span>
<span class="r-in"><span> <span class="va">xt</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">100</span>,<span class="cn">TRUE</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">100</span>,<span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">observed</span><span class="op">&lt;-</span><span class="va">xt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">expected</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">observed</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">observed</span><span class="op">)</span>,<span class="st">"*"</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">xt</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">deviates</span><span class="op">&lt;-</span><span class="op">(</span><span class="va">observed</span><span class="op">-</span><span class="va">expected</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">cellcol</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#000000"</span>,<span class="fl">100</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">cellcol</span><span class="op">[</span><span class="va">deviates</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="va">deviates</span><span class="op">[</span><span class="va">deviates</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.8</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">cellcol</span><span class="op">[</span><span class="va">deviates</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="va">deviates</span><span class="op">[</span><span class="va">deviates</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">]</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="fl">0.8</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu">color2D.matplot</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">deviates</span>,<span class="fl">2</span><span class="op">)</span>,cellcolors<span class="op">=</span><span class="va">cellcol</span>,</span></span>
<span class="r-in"><span>  show.values<span class="op">=</span><span class="cn">TRUE</span>,main<span class="op">=</span><span class="st">"Association plot"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="color2D.matplot-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="co"># Hinton diagram</span></span></span>
<span class="r-in"><span> <span class="va">border.col</span><span class="op">&lt;-</span><span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="va">x</span>,extremes<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu">color2D.matplot</span><span class="op">(</span><span class="va">x</span>,extremes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,main<span class="op">=</span><span class="st">"Hinton diagram (green +, red -)"</span>,</span></span>
<span class="r-in"><span>  Hinton<span class="op">=</span><span class="cn">TRUE</span>,border<span class="op">=</span><span class="va">border.col</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="color2D.matplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="co"># waffle plot of percentages with two contributing elements</span></span></span>
<span class="r-in"><span> <span class="va">waffle.col</span><span class="op">&lt;-</span><span class="fu"><a href="fill.corner.html">fill.corner</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="fl">18</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"blue"</span>,<span class="fl">45</span><span class="op">)</span><span class="op">)</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu">color2D.matplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,nrow<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,cellcolors<span class="op">=</span><span class="va">waffle.col</span>,yrev<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  border<span class="op">=</span><span class="st">"lightgray"</span>,xlab<span class="op">=</span><span class="st">""</span>,ylab<span class="op">=</span><span class="st">""</span>,main<span class="op">=</span><span class="st">"Waffle plot"</span>,axes<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="color2D.matplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span> <span class="co"># coarse density plot of the iris petal data</span></span></span>
<span class="r-in"><span> <span class="va">spnames</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">spcols</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"green"</span>,<span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">matmax</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">cindx</span><span class="op">&lt;-</span><span class="fl">1</span></span></span>
<span class="r-in"><span> <span class="kw">for</span><span class="op">(</span><span class="va">isp</span> <span class="kw">in</span> <span class="va">spnames</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">petal_mat</span><span class="op">&lt;-</span><span class="fu"><a href="makeDensityMatrix.html">makeDensityMatrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="va">isp</span>,<span class="st">"Petal.Length"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>   <span class="va">iris</span><span class="op">[</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span> <span class="op">==</span> <span class="va">isp</span>,<span class="st">"Petal.Width"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>   nx<span class="op">=</span><span class="fl">20</span>,ny<span class="op">=</span><span class="fl">20</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2.5</span><span class="op">)</span>,geocoord<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># center the maximum markers in the cells</span></span></span>
<span class="r-in"><span>  <span class="va">matmax</span><span class="op">[[</span><span class="va">cindx</span><span class="op">]</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="find_max_cell.html">find_max_cell</a></span><span class="op">(</span><span class="va">petal_mat</span><span class="op">)</span>,<span class="st">"-"</span>,<span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="va">isp</span> <span class="op">==</span> <span class="st">"setosa"</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu">color2D.matplot</span><span class="op">(</span><span class="va">petal_mat</span>,main<span class="op">=</span><span class="st">"Iris petal length by petal width"</span>,</span></span>
<span class="r-in"><span>    xlab<span class="op">=</span><span class="st">"Petal length (cm)"</span>,ylab<span class="op">=</span><span class="st">"Petal width (cm)"</span>,axes<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    cellcolors<span class="op">=</span><span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="va">petal_mat</span>,extremes<span class="op">=</span><span class="va">spcols</span><span class="op">[</span><span class="va">cindx</span><span class="op">]</span>,alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    border<span class="op">=</span><span class="cn">NA</span>,yrev<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">else</span></span></span>
<span class="r-in"><span>   <span class="fu">color2D.matplot</span><span class="op">(</span><span class="va">petal_mat</span>,border<span class="op">=</span><span class="cn">NA</span>,yrev<span class="op">=</span><span class="cn">FALSE</span>,add<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   cellcolors<span class="op">=</span><span class="fu"><a href="color.scale.html">color.scale</a></span><span class="op">(</span><span class="va">petal_mat</span>,extremes<span class="op">=</span><span class="va">spcols</span><span class="op">[</span><span class="va">cindx</span><span class="op">]</span>,alpha<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">cindx</span><span class="op">&lt;-</span><span class="va">cindx</span><span class="op">+</span><span class="fl">1</span></span></span>
<span class="r-in"><span> <span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Range of density (&gt;0) - 1 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Range of density (&gt;0) - 1 9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Range of density (&gt;0) - 1 6 </span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>,at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span>,by<span class="op">=</span><span class="fl">3.33</span><span class="op">)</span>,labels<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>,at<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span>,length.out<span class="op">=</span><span class="fl">4</span><span class="op">)</span>,labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2.5</span>,by<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">6</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">spnames</span>,<span class="st">"("</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="st">")"</span><span class="op">)</span>,fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>,<span class="st">"green"</span>,<span class="st">"blue"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="kw">for</span><span class="op">(</span><span class="va">cindx</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">matmax</span><span class="op">[[</span><span class="va">cindx</span><span class="op">]</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">cindx</span><span class="op">)</span>,col<span class="op">=</span><span class="st">"white"</span>,cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="color2D.matplot-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jim Lemon.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

